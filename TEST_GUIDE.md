# 🧪 本地测试指南

## 📋 测试前准备

### 1. 检查依赖
```bash
# 确保已安装所有依赖
pip3 install -r requirements.txt
```

### 2. 检查数据库
```bash
# 确保数据库文件存在
ls -la pet_food_selection.db
```

### 3. 启动后端服务
```bash
# 在项目根目录运行
uvicorn main_sqlite:app --reload --host 0.0.0.0 --port 8000
```

后端服务启动后，访问：http://localhost:8000

## ✅ 功能测试清单

### 第一步：宠物信息填写
- [ ] 选择宠物类型（猫/狗）
- [ ] 输入品种
- [ ] 输入年龄（年/月）
- [ ] 选择健康状况（至少1项，最多2项）
- [ ] 可选：输入体重、是否绝育、活动水平等
- [ ] 点击"下一步"按钮（顶部和底部都要测试）
- [ ] 验证必填项提示是否正常

### 第二步：产品选择
- [ ] 页面正常加载产品列表
- [ ] 分类筛选功能正常
- [ ] 搜索功能正常（品牌、型号、功能）
- [ ] 价格区间筛选正常（抽屉可展开/收起）
- [ ] 点击产品卡片可以选中/取消
- [ ] 自定义勾选样式显示正常
- [ ] "系统推荐"功能正常
- [ ] "手动输入"功能正常
- [ ] 已选产品数量显示正确
- [ ] "开始分析"按钮（顶部和底部）都能正常工作
- [ ] "返回上一步"按钮正常

### 第三步：智能分析
- [ ] 分析页面正常显示
- [ ] 预计剩余时间显示（不显示每款产品时间）
- [ ] 进度条正常更新（0% → 90% → 100%）
- [ ] 百分比显示正常
- [ ] 分析完成后自动跳转到结果页

### 第四步：分析结果
- [ ] 结果页面正常加载
- [ ] 双Tab切换正常（纯营养视角 / 性价比综合排名）
- [ ] 产品列表显示匿名代码（A/B/C...）
- [ ] 排名显示正确（#1, #2...）
- [ ] 每斤价格显示正确
- [ ] 点击"显示真实产品名"按钮正常
- [ ] 产品名显示后不再显示按钮
- [ ] 点击"查看详情"弹窗正常
- [ ] "导出分析结果图片"按钮正常
- [ ] 导出功能正常（生成PNG图片）
- [ ] 导出的图片包含：
  - [ ] 宠物信息
  - [ ] 产品排名（真实产品名）
  - [ ] 推荐理由
  - [ ] 生成时间

### 其他功能
- [ ] 首次使用引导正常显示
- [ ] 引导可以关闭
- [ ] 关闭后不再显示
- [ ] 响应式设计正常（手机/PC）
- [ ] 所有按钮都有响应
- [ ] 错误提示正常显示
- [ ] 网络错误处理正常

## 🐛 常见问题排查

### 1. 后端无法启动
```bash
# 检查端口是否被占用
lsof -i :8000

# 检查Python版本（需要3.7+）
python3 --version
```

### 2. 前端无法访问后端
- 检查 `static/app_fixed.js` 中的 `API_BASE` 配置
- 确认后端服务正在运行
- 检查浏览器控制台的CORS错误

### 3. 导出图片失败
- 检查是否加载了 html2canvas 库
- 查看浏览器控制台错误信息
- 确认网络连接正常（首次需要加载库）

### 4. 产品选择页面空白
- 检查后端 `/api/products` 接口是否正常
- 查看浏览器网络请求
- 检查数据库是否有产品数据

### 5. 分析结果不显示
- 检查分析是否完成
- 查看浏览器控制台错误
- 检查后端日志

## 📝 测试记录

建议记录以下信息：
- 测试日期：___________
- 测试浏览器：___________
- 测试设备：___________
- 发现的问题：___________
- 修复情况：___________

## 🚀 测试通过后

如果所有功能测试通过，可以：
1. 提交代码到GitHub
2. 按照 `DEPLOYMENT.md` 进行部署
3. 在生产环境再次测试

